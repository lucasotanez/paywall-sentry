function getDiv(id : string, color : string) : Element[] | null{
  let targetBox = document.getElementById(id)
  let links 
  if (targetBox != null) links = targetBox.querySelectorAll(".yuRUbf")
  else throw "Error"
  links = Array.from(links)
  let index : number = links.length - 1;
  console.log(blacklist)
  
  console.log(links)
  console.log(links[1].getElementsByTagName("a")[0].getAttribute("href"))
  let regExp = /\/[//]([^/]+)\//
  while (index >= 0) {
    let fullUrl = links[index].getElementsByTagName("a")[0].getAttribute("href");
    let base : RegExpExecArray | string | null = null
    if (typeof fullUrl == 'string' ) base = regExp.exec(fullUrl);
    if (base != null) base = base[1];
    if (typeof base == 'string') {
      if (blacklist.has(base)) {
        links.splice(index, 1);
      } else {
        console.log(base)
      }
    }
    console.log("here")
    index -= 1;
  }

  return links 
}

let blacklist = new Map<string, null>()
blacklist.set("www.chegg.com", null)
blacklist.set("homework.study.com", null)
blacklist.set("www.numerade.com", null)

let color = "test"

chrome.action.onClicked.addListener(async (tab) => {
    
  chrome.scripting.executeScript({
    target: {tabId: tab.id ? tab.id : -1},
    func: getDiv,
    args: ["search", color]
  }).then();
});


